name: sonic-vxlan
prefix: ""
mgmt: {}
topology:
  kinds:
    linux:
      image: debian:buster
    sonic-vs:
      image: sonic-vs:202111
      binds:
        - conf/daemons:/etc/frr/daemons
        - conf/start.sh:/usr/bin/start.sh
      sysctls:
        net.ipv6.conf.all.disable_ipv6: 0
  nodes:
    leaf01:
      kind: sonic-vs
      binds:
        - conf/leaf01.yaml:/etc/sonic/custom_setup.yaml
        - conf/leaf01.conf:/etc/frr/frr.conf
    leaf02:
      kind: sonic-vs
      binds:
        - conf/leaf02.yaml:/etc/sonic/custom_setup.yaml
        - conf/leaf02.conf:/etc/frr/frr.conf
    server01:
      kind: linux
      exec:
        - ip addr add 192.168.1.1/24 dev eth1
        - ip route add 192.168.2.0/24 via 192.168.1.254
    server02:
      kind: linux
      exec:
        - ip addr add 192.168.2.2/24 dev eth1
        - ip route add 192.168.1.0/24 via 192.168.2.254
    spine01:
      kind: sonic-vs
      binds:
        - conf/spine01.yaml:/etc/sonic/custom_setup.yaml
        - conf/spine01.conf:/etc/frr/frr.conf
    spine02:
      kind: sonic-vs
      binds:
        - conf/spine02.yaml:/etc/sonic/custom_setup.yaml
        - conf/spine02.conf:/etc/frr/frr.conf
  links:
  - endpoints: ["spine01:eth1", "leaf01:eth1"]
  - endpoints: ["spine01:eth2", "leaf02:eth1"]
  - endpoints: ["spine02:eth1", "leaf01:eth2"]
  - endpoints: ["spine02:eth2", "leaf02:eth2"]
  - endpoints: ["leaf01:eth3", "server01:eth1"]
  - endpoints: ["leaf02:eth3", "server02:eth1"]

